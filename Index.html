<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Happy New Year My Love, Widia ü§ç</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; }

body {
 margin: 0;
 height: 100vh;
 background: radial-gradient(circle at top, #ffb6c1, #ff6f91, #6a0572);
 font-family: 'Poppins', sans-serif;
 color: white;
 overflow: hidden;
}

canvas {
 position: fixed;
 inset: 0;
 z-index: 0;
}

/* AUDIO BUTTON */
.audio-btn {
 position: fixed;
 bottom: 25px;
 right: 25px;
 width: 55px;
 height: 55px;
 border-radius: 50%;
 background: rgba(255,255,255,0.25);
 backdrop-filter: blur(10px);
 border: 1px solid rgba(255,255,255,0.4);
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 1.4rem;
 cursor: pointer;
 z-index: 99;
 transition: 0.4s;
}
.audio-btn.muted::after {
 content: "‚úï";
 position: absolute;
 font-size: 2rem;
 color: #ff3b7d;
}

/* PAGE SYSTEM */
.page {
 position: absolute;
 inset: 0;
 display: flex;
 justify-content: center;
 align-items: center;
 opacity: 0;
 transform: scale(0.96);
 transition: 1.2s ease;
 pointer-events: none;
 z-index: 1;
}
.page.active {
 opacity: 1;
 transform: scale(1);
 pointer-events: auto;
}

.card {
 max-width: 850px;
 width: 90%;
 background: rgba(255,255,255,0.14);
 border-radius: 35px;
 padding: 55px;
 backdrop-filter: blur(18px);
 box-shadow: 0 0 70px rgba(255,182,193,0.45);
 text-align: center;
}

/* CARD HEIGHT FOR PAGE 3 */
#p3 .card {
  max-height: 85vh;
  overflow-y: auto;
  padding-bottom: 80px; /* biar button aman */
}

/* scrollbar */
#p3 .card::-webkit-scrollbar {
  width: 6px;
}
#p3 .card::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.4);
  border-radius: 10px;
}
#p3 .card::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.1);
  border-radius: 10px;
}
h1, h2 {
 font-family: 'Playfair Display', serif;
 font-weight: 600;
}

h1 { font-size: 3.2rem; }
h2 { font-size: 2.4rem; }

p {
 font-size: 1rem;
 line-height: 1.8;
 opacity: 0.95;
}

button {
 margin-top: 30px;
 padding: 16px 42px;
 border-radius: 45px;
 border: none;
 background: linear-gradient(135deg,#ff8fab,#ff5f9e);
 color: white;
 font-size: 1rem;
 cursor: pointer;
 transition: 0.5s;
}
button:hover {
 transform: scale(1.1);
 box-shadow: 0 0 30px rgba(255,182,193,0.9);
}

img {
 width: 250px;
 border-radius: 30px;
 margin: 30px 0;
 box-shadow: 0 0 40px rgba(255,255,255,0.45);
}

video {
 width: 100%;
 max-width: 700px;
 border-radius: 30px;
 margin-top: 25px;
}

/* PORTRAIT VIDEO SIZE */
#p4 video {
  width: 320px;
  height: 570px;
  object-fit: cover;
  display: block;
  margin: 25px auto 0;
}

#p4 .card {
  max-height: 90vh;
  overflow-y: auto;
}

/* POPUP */
.popup {
 position: fixed;
 inset: 0;
 background: rgba(0,0,0,0.65);
 display: none;
 justify-content: center;
 align-items: center;
 z-index: 10;
}
.popup-content {
 background: rgba(255,255,255,0.25);
 padding: 35px;
 border-radius: 30px;
 backdrop-filter: blur(12px);
 text-align: center;
}
</style>
</head>

<body>

<canvas id="fireworks"></canvas>

<audio id="bgm" src="song.mp3" loop></audio>
<div class="audio-btn" id="audioBtn" onclick="toggleMute()">üîä</div>

<!-- PAGE 1 -->
<div class="page active" id="p1">
 <div class="card">
   <h1>Happy New Year, My Love Widia ü§ç</h1>
   <p>This year begins with you, and it already feels like home.</p>
   <button onclick="go(2)">Open the surprise</button>
 </div>
</div>

<!-- PAGE 2 -->
<div class="page" id="p2">
 <div class="card">
   <h2>Are you ready, baby?</h2>
   <button onclick="go(3)">Yes ü§ç</button>
   <button onclick="popup(1)">No ü•∫</button>
 </div>
</div>

<!-- PAGE 3 -->
<div class="page" id="p3">
 <div class="card">
   <h2>The girl my heart adore the most</h2>
   <img src="photo.jpg">
   <p><b>Widia Wati</b></p>
   <p>10 December 2004</p>
   <p>Status: Taken by her future husband</p>
   <p>
     Kindly cute in the way she smiles, gentle in the way she moves,
     and caring in the way she loves.
     A soft heart with a warm presence,
     bringing comfort without effort,
     Loving, sincere, and naturally calming,
     A soul that makes everything feel a little safer and a little brighter.
   </p>
   <p><i>Please verify if this biodata truly belongs to you</i></p>
   <button onclick="go(4)">Yes, it is me</button>
   <button onclick="popup(2)">No, it's not me</button>
 </div>
</div>

<!-- PAGE 4 -->
<div class="page" id="p4">
 <div class="card">
   <h2>Only for the girl who truly owns my heart ü§ç</h2>
   <iframe 
    src="https://drive.google.com/file/d/1heSVKPjRZI7bwBJp020rzBSVcouDg9xD/preview" 
    width="320" 
    height="570" 
    style="border:0;" 
    allow="autoplay" 
    allowfullscreen>
</iframe>
   <p style="margin-top:25px">
     In 2025, I loved you more deeply than I ever thought I could. 
     The way you cared for me, 
     stayed gentle with my heart, 
     and showed love in the smallest ways made every day feel meaningful. 
     Thank you, my love. 
     I love you so deeply that words can no longer describe how much you mean to me.
   </p>
   <button onclick="restart()">Restart from the beginning, My Loveü§ç?</button>
 </div>
</div>

<!-- POPUPS -->
<div class="popup" id="pop1">
 <div class="popup-content">
   <p>Unknown Error: Unable to process your action.<br>Please try again later.</p>
   <img src="gif1.gif">
   <button onclick="closePop()">Close</button>
 </div>
</div>

<div class="popup" id="pop2">
 <div class="popup-content">
   <p>Are you sure she is not you? ü§®</p>
   <img src="gif2.gif">
   <button onclick="closePop()">Close</button>
 </div>
</div>

<script>
/* PAGE NAV */
function go(n) {
 document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
 document.getElementById('p'+n).classList.add('active');
 document.getElementById('bgm').play();
}
function popup(n){ document.getElementById('pop'+n).style.display='flex'; }
function closePop(){ document.querySelectorAll('.popup').forEach(p=>p.style.display='none'); }

/* AUDIO */
function toggleMute(){
 const a=document.getElementById('bgm');
 const b=document.getElementById('audioBtn');
 a.muted=!a.muted;
 b.classList.toggle('muted',a.muted);
}

/* ================= CANVAS ================= */
const canvas = document.getElementById("fireworks");
const ctx = canvas.getContext("2d");

canvas.width = innerWidth;
canvas.height = innerHeight;

addEventListener("resize", () => {
 canvas.width = innerWidth;
 canvas.height = innerHeight;
});

/* ================= GLOBAL ================= */
let particles = [];
let rockets = [];

const fireNumber = 18;   // üî• LEBIH PADAT
const range = 80;

/* ================= COLORS ================= */
function randColor() {
 const colors = [
   "255,105,180",
   "255,140,200",
   "255,182,193",
   "255,200,220",
   "255,255,255"
 ];
 return colors[Math.floor(Math.random() * colors.length)];
}

/* ================= ROCKET ================= */
function launchFirework(amount = 1) {
 for (let i = 0; i < amount; i++) {
   rockets.push({
     x: Math.random() * canvas.width,
     y: canvas.height + 20,
     vy: Math.random() * -9 - 10
   });
 }
}

/* ================= FULL CIRCLE ================= */
function makeFullCircleFirework(fire) {
 const color = randColor();
 const speed = Math.random() * 6 + 7;
 const count = fireNumber * 8; // üî• LEDAKAN BESAR

 for (let i = 0; i < count; i++) {
   const angle = (i / count) * Math.PI * 2;

   particles.push({
     x: fire.x,
     y: fire.y,
     size: Math.random() * 1.5 + 1.5,
     color,
     vx: Math.cos(angle) * speed + (Math.random() - 0.5) * 1.5,
     vy: Math.sin(angle) * speed + (Math.random() - 0.5) * 1.5,
     gravity: 0.08,
     friction: 0.982,
     alpha: 1,
     decay: Math.random() * 0.012 + 0.008
   });
 }
}

/* ================= HEART ================= */
function makeHeartFirework(x, y) {
 const color = randColor();
 const scale = 14;

 for (let t = 0; t < Math.PI * 2; t += 0.12) {
   const px = scale * 16 * Math.pow(Math.sin(t), 3);
   const py = -scale * (
     13 * Math.cos(t) -
     5 * Math.cos(2 * t) -
     2 * Math.cos(3 * t) -
     Math.cos(4 * t)
   );

   particles.push({
     x,
     y,
     size: 2,
     color,
     vx: px * 0.045,
     vy: py * 0.045,
     gravity: 0.02,
     friction: 0.99,
     alpha: 1,
     decay: 0.01
   });
 }
}

/* ================= UPDATE ================= */
function updateRockets() {
 for (let i = rockets.length - 1; i >= 0; i--) {
   const r = rockets[i];
   r.y += r.vy;
   r.vy += 0.18;

   if (r.vy >= -2) {
     // üí• MULTI BURST
     makeFullCircleFirework(r);
     if (Math.random() < 0.6)
       setTimeout(() => makeHeartFirework(r.x, r.y), 120);
     if (Math.random() < 0.4)
       setTimeout(() => makeFullCircleFirework(r), 220);

     rockets.splice(i, 1);
   }
 }
}

function updateParticles() {
 for (let i = particles.length - 1; i >= 0; i--) {
   const p = particles[i];

   p.vx *= p.friction;
   p.vy *= p.friction;
   p.vy += p.gravity;

   p.x += p.vx;
   p.y += p.vy;
   p.alpha -= p.decay;

   if (p.alpha <= 0) {
     particles.splice(i, 1);
     continue;
   }

   ctx.beginPath();
   ctx.fillStyle = `rgba(${p.color}, ${p.alpha})`;
   ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
   ctx.fill();
 }
}

/* ================= ANIMATE ================= */
function animate() {
 ctx.fillStyle = "rgba(0,0,0,0.12)"; // smoother trail
 ctx.fillRect(0, 0, canvas.width, canvas.height);

 updateRockets();
 updateParticles();
 requestAnimationFrame(animate);
}
animate();

/* ================= FIREWORK STORM ================= */
setInterval(() => {
 launchFirework(Math.floor(Math.random() * 3) + 2); // üöÄ 2‚Äì4 rockets
}, 700); // üî• LEBIH CEPAT

function restart() {
  // stop video if playing
  const video = document.querySelector("#p4 video");
  if (video) {
    video.pause();
    video.currentTime = 0;
  }

  // reset pages
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('p1').classList.add('active');

  // optional: little firework boom pas restart
  launchFirework(6);
}

const bgm = document.getElementById("bgm");
const video = document.querySelector("#p4 video");

if (video) {
  video.addEventListener("play", () => {
    bgm.pause(); // üéµ musik mati saat video diputar
  });

  video.addEventListener("pause", () => {
    bgm.play(); // üéµ musik nyala lagi saat video di-pause
  });

  video.addEventListener("ended", () => {
    bgm.play(); // üéµ musik nyala lagi saat video selesai
  });
}

function go(n) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('p'+n).classList.add('active');
  document.getElementById('bgm').play();

  if(n === 4) { // pas masuk page 4
    const bgm = document.getElementById("bgm");
    const video = document.querySelector("#p4 video");

    if(video && !video.hasAttribute('data-listener')) {
      video.addEventListener("play", () => bgm.pause());
      video.addEventListener("pause", () => bgm.play());
      video.addEventListener("ended", () => bgm.play());
      video.setAttribute('data-listener', 'true'); // biar ga nambah listener berulang
    }
  }
}

</script>

</script>

</body>
</html>

